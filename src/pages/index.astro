---
import { SOCIALS } from "src/config";
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import LinkButton from "@components/LinkButton.astro";
import Hr from "@components/Hr.astro";
import Card from "@components/Card";
import getSortedPosts from "@utils/getSortedPosts";
import socialIcons from "@assets/socialIcons";
import slugify from "@utils/slugify";
import type { Frontmatter } from "src/types";

import external from "../contents/external.json";

const posts = await Astro.glob<Frontmatter>("../contents/*.md");
const allPosts = [...posts, ...external];

const sortedPosts = getSortedPosts(allPosts);

---

<Layout>
  <Header />
  <div id="swup">
    <main id="main-content">
      <section id="hero">
        <h1>Darko's corner</h1>
        <p>
          ðŸ‘‹ Hi! I'm Darko. I write software, mostly for the web. I'm also a writer, speaker, community person and Linux nerd.
          I enjoy working with the web platform, warts included and I remember the IE6 days (yes, Iâ€™ve been in this industry for 15+ years now ðŸ˜Š).
          <br /><br />
          ðŸ§ª I love the experimental and trailblazing aspect of web development - development should have at least SOME fun in it ðŸ˜‰
          <br />
          ðŸ‘¥ I run a <a href="https://beerjs.mk">meetup</a>, help organize a <a href="https://devcon.dev">conference</a>, have taught at web academies, and mentored colleagues. Iâ€™ve also spoken at meetups and conferences.
          <br />
          ðŸ’» Iâ€™ve led teams, built apps, and created libraries. Iâ€™ve freelanced and worked as an individual contributor and in teams. I love FOSS and contribute when I can. My experience spans a large number of industries. You can find my portfolio <a href="https://work.darko.io">here</a>.
          <br />
          ðŸŒŸ And, Iâ€™m very much looking to get into DevRel ðŸ˜Š
        </p>
        <div class="social-wrapper">
          <div class="whitespace-nowrap">Darko around the web:</div>
          <div class="social-icons">
            {
              SOCIALS.filter((social) => social.active).map((social) => (
                <LinkButton
                  href={social.href}
                  className="link-button"
                  title={social.name}
                >
                  <Fragment set:html={socialIcons[social.name]} />
                </LinkButton>
              ))
            }
          </div>
        </div>
      </section>
  
      <Hr />
  
      <section id="recent-posts">
        <h2>Recent Posts</h2>
        <ul>
          {
            sortedPosts.map(
              ({ frontmatter }, index) =>
                index < 4 && (
                  <Card
                    href={frontmatter.url || `/posts/${slugify(frontmatter)}`}
                    post={frontmatter}
                    secHeading={false}
                  />
                )
            )
          }
        </ul>
        <div class="all-posts-btn-wrapper">
          <LinkButton href="/posts">
            All Posts
            <svg xmlns="http://www.w3.org/2000/svg"
              ><path
                d="m11.293 17.293 1.414 1.414L19.414 12l-6.707-6.707-1.414 1.414L15.586 11H6v2h9.586z"
              ></path>
            </svg>
          </LinkButton>
        </div>
      </section>
    </main>
  </div>
  <Footer />
</Layout>

<style>
  /* ===== Hero Section ===== */
  #hero {
    @apply pt-8;
  }
  #hero h1 {
    @apply inline-block font-bold my-4 sm:my-8 text-3xl sm:text-5xl;
  }
  #hero .rss-link {
    @apply mb-6;
  }
  #hero .rss-icon {
    @apply h-6 w-6 scale-110 sm:scale-125 mb-2 sm:mb-3 fill-skin-accent;
  }
  #hero p {
    @apply my-2;
  }
  #hero p a {
    @apply text-skin-accent underline;
  }
  .social-wrapper {
    @apply flex flex-col sm:flex-row sm:items-center mt-4 mb-6;
  }
  .social-icons {
    @apply mt-1 sm:mt-0 sm:ml-2 sm:space-x-1;
  }
  .link-button {
    @apply p-2 sm:p-1 hover:rotate-6;
  }

  /* ===== Featured & Recent Posts Sections ===== */
  #featured,
  #recent-posts {
    @apply pt-12 pb-6;
  }
  #featured h2,
  #recent-posts h2 {
    @apply font-semibold text-2xl tracking-wide;
  }

  .all-posts-btn-wrapper {
    @apply text-center my-8;
  }
</style>
